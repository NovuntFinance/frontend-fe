{
  "auth_routes_requests": {
    "legacy_auth_routes": {
      "register": {
        "method": "POST",
        "path": "/api/v1/auth/register",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          },
          "User-Agent": {
            "type": "string",
            "required": false,
            "description": "Used for security logging and fraud detection"
          }
        },
        "body": {
          "fname": {
            "type": "string",
            "required": true,
            "description": "User's first name"
          },
          "lname": {
            "type": "string",
            "required": true,
            "description": "User's last name"
          },
          "email": {
            "type": "string",
            "required": true,
            "format": "email",
            "description": "User's email address (will be sanitized and lowercased)"
          },
          "username": {
            "type": "string",
            "required": true,
            "minLength": 3,
            "maxLength": 30,
            "description": "Unique username (will be sanitized and lowercased)"
          },
          "password": {
            "type": "string",
            "required": true,
            "minLength": 8,
            "pattern": "^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{8,}$",
            "description": "Password must include uppercase, lowercase, number, and special character"
          },
          "confirmPassword": {
            "type": "string",
            "required": true,
            "description": "Must match password field"
          },
          "referralCode": {
            "type": "string",
            "required": false,
            "description": "Optional referral code (will be uppercased)"
          }
        },
        "example": {
          "fname": "John",
          "lname": "Doe",
          "email": "john.doe@example.com",
          "username": "johndoe",
          "password": "SecurePass123!",
          "confirmPassword": "SecurePass123!",
          "referralCode": "ABC123XYZ"
        }
      },
      "verify_email": {
        "method": "POST",
        "path": "/api/v1/auth/verify-email",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          }
        },
        "body": {
          "email": {
            "type": "string",
            "required": true,
            "format": "email",
            "description": "Email address to resend verification code"
          }
        },
        "rate_limiting": {
          "window": "60 seconds",
          "max_attempts": 1,
          "description": "Must wait 60 seconds between resend attempts"
        },
        "example": {
          "email": "john.doe@example.com"
        }
      },
      "complete_registration": {
        "method": "POST",
        "path": "/api/v1/auth/complete-registration",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          }
        },
        "body": {
          "email": {
            "type": "string",
            "required": true,
            "format": "email",
            "description": "Email address used during registration"
          },
          "verificationCode": {
            "type": "string",
            "required": true,
            "description": "6-digit TOTP code sent to email"
          }
        },
        "example": {
          "email": "john.doe@example.com",
          "verificationCode": "123456"
        }
      },
      "login": {
        "method": "POST",
        "path": "/api/v1/auth/login",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          },
          "User-Agent": {
            "type": "string",
            "required": false,
            "description": "Used for security logging and device tracking"
          }
        },
        "body": {
          "email": {
            "type": "string",
            "required": false,
            "format": "email",
            "description": "User's email (either email OR username required, not both)"
          },
          "username": {
            "type": "string",
            "required": false,
            "description": "User's username (either email OR username required, not both)"
          },
          "password": {
            "type": "string",
            "required": true,
            "description": "User's password"
          }
        },
        "example": {
          "email": "john.doe@example.com",
          "password": "SecurePass123!"
        }
      },
      "verify_2fa": {
        "method": "POST",
        "path": "/api/v1/auth/verify-2fa",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          }
        },
        "body": {
          "userID": {
            "type": "string",
            "required": true,
            "format": "ObjectId",
            "description": "User ID returned from login response when 2FA is enabled"
          },
          "token": {
            "type": "string",
            "required": true,
            "description": "6-digit TOTP code from authenticator app"
          }
        },
        "example": {
          "userID": "507f1f77bcf86cd799439011",
          "token": "123456"
        }
      },
      "generate_2fa_secret": {
        "method": "POST",
        "path": "/api/v1/auth/generate-2fa-secret",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          },
          "Authorization": {
            "type": "string",
            "required": true,
            "format": "Bearer <token>",
            "description": "JWT access token"
          }
        },
        "body": {
          "email": {
            "type": "string",
            "required": true,
            "format": "email",
            "description": "User's email address"
          }
        },
        "example": {
          "email": "john.doe@example.com"
        }
      },
      "enable_2fa": {
        "method": "POST",
        "path": "/api/v1/auth/enable-2fa",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          },
          "Authorization": {
            "type": "string",
            "required": true,
            "format": "Bearer <token>",
            "description": "JWT access token"
          }
        },
        "body": {
          "email": {
            "type": "string",
            "required": true,
            "format": "email",
            "description": "User's email address"
          },
          "token": {
            "type": "string",
            "required": true,
            "description": "6-digit TOTP code from authenticator app"
          },
          "secret": {
            "type": "string",
            "required": true,
            "description": "Base32 secret returned from generate-2fa-secret"
          }
        },
        "example": {
          "email": "john.doe@example.com",
          "token": "123456",
          "secret": "JBSWY3DPEHPK3PXP"
        }
      },
      "refresh_token": {
        "method": "POST",
        "path": "/api/v1/auth/refresh-token",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          }
        },
        "body": {
          "refreshToken": {
            "type": "string",
            "required": true,
            "description": "Valid refresh token received during login"
          }
        },
        "example": {
          "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        }
      },
      "revoke_token": {
        "method": "POST",
        "path": "/api/v1/auth/revoke-token",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          },
          "Authorization": {
            "type": "string",
            "required": true,
            "format": "Bearer <token>",
            "description": "JWT access token"
          }
        },
        "body": {
          "refreshToken": {
            "type": "string",
            "required": true,
            "description": "Refresh token to revoke (logout from specific device)"
          }
        },
        "example": {
          "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        }
      },
      "logout_all_devices": {
        "method": "POST",
        "path": "/api/v1/auth/logout-all-devices",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          },
          "Authorization": {
            "type": "string",
            "required": true,
            "format": "Bearer <token>",
            "description": "JWT access token"
          }
        },
        "body": {},
        "description": "No body required - revokes all refresh tokens and increments token version",
        "example": {}
      },
      "logout": {
        "method": "POST",
        "path": "/api/v1/auth/logout",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          },
          "Authorization": {
            "type": "string",
            "required": true,
            "format": "Bearer <token>",
            "description": "JWT access token"
          }
        },
        "body": {},
        "description": "No body required - destroys session",
        "example": {}
      },
      "update_password": {
        "method": "PATCH",
        "path": "/api/v1/auth/password",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          },
          "Authorization": {
            "type": "string",
            "required": true,
            "format": "Bearer <token>",
            "description": "JWT access token"
          }
        },
        "body": {
          "currentPassword": {
            "type": "string",
            "required": true,
            "description": "User's current password"
          },
          "newPassword": {
            "type": "string",
            "required": true,
            "minLength": 8,
            "pattern": "^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{8,}$",
            "description": "New password meeting complexity requirements"
          },
          "confirmNewPassword": {
            "type": "string",
            "required": true,
            "description": "Must match newPassword"
          }
        },
        "example": {
          "currentPassword": "OldSecurePass123!",
          "newPassword": "NewSecurePass456!",
          "confirmNewPassword": "NewSecurePass456!"
        }
      },
      "reset_password_request": {
        "method": "POST",
        "path": "/api/v1/auth/reset-password/request",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          }
        },
        "body": {
          "email": {
            "type": "string",
            "required": true,
            "format": "email",
            "description": "User's email to send reset OTP"
          }
        },
        "example": {
          "email": "john.doe@example.com"
        }
      },
      "reset_password": {
        "method": "POST",
        "path": "/api/v1/auth/reset-password",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          }
        },
        "body": {
          "token": {
            "type": "string",
            "required": true,
            "description": "Password reset token from email"
          },
          "newPassword": {
            "type": "string",
            "required": true,
            "minLength": 8,
            "pattern": "^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{8,}$",
            "description": "New password meeting complexity requirements"
          },
          "confirmNewPassword": {
            "type": "string",
            "required": true,
            "description": "Must match newPassword"
          }
        },
        "example": {
          "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
          "newPassword": "NewSecurePass456!",
          "confirmNewPassword": "NewSecurePass456!"
        }
      },
      "referral_info": {
        "method": "GET",
        "path": "/api/v1/auth/referral-info",
        "headers": {
          "Authorization": {
            "type": "string",
            "required": true,
            "format": "Bearer <token>",
            "description": "JWT access token"
          }
        },
        "query_parameters": {},
        "body": {},
        "description": "No body or query parameters required",
        "example": {}
      }
    },
    "better_auth_routes": {
      "register": {
        "method": "POST",
        "path": "/api/v1/better-auth/register",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          }
        },
        "body": {
          "email": {
            "type": "string",
            "required": true,
            "format": "email",
            "description": "User's email address"
          },
          "password": {
            "type": "string",
            "required": true,
            "minLength": 8,
            "description": "User's password"
          },
          "confirmPassword": {
            "type": "string",
            "required": true,
            "description": "Must match password field"
          },
          "firstName": {
            "type": "string",
            "required": true,
            "description": "User's first name"
          },
          "lastName": {
            "type": "string",
            "required": true,
            "description": "User's last name"
          },
          "username": {
            "type": "string",
            "required": true,
            "description": "Unique username"
          },
          "phoneNumber": {
            "type": "string",
            "required": false,
            "description": "User's phone number"
          },
          "countryCode": {
            "type": "string",
            "required": false,
            "description": "Country code (e.g., +1, +234)"
          },
          "referralCode": {
            "type": "string",
            "required": false,
            "description": "Optional referral code"
          }
        },
        "example": {
          "email": "jane.doe@example.com",
          "password": "SecurePass123!",
          "confirmPassword": "SecurePass123!",
          "firstName": "Jane",
          "lastName": "Doe",
          "username": "janedoe",
          "phoneNumber": "1234567890",
          "countryCode": "+1",
          "referralCode": "ABC123"
        }
      },
      "login": {
        "method": "POST",
        "path": "/api/v1/better-auth/login",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          }
        },
        "body": {
          "email": {
            "type": "string",
            "required": true,
            "format": "email",
            "description": "User's email address"
          },
          "password": {
            "type": "string",
            "required": true,
            "description": "User's password"
          }
        },
        "cookies": {
          "auth_token": {
            "description": "HTTP-only cookie set on successful login",
            "httpOnly": true,
            "secure": true,
            "maxAge": "24 hours"
          }
        },
        "example": {
          "email": "jane.doe@example.com",
          "password": "SecurePass123!"
        }
      },
      "verify_email": {
        "method": "POST",
        "path": "/api/v1/better-auth/verify-email",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          }
        },
        "body": {
          "email": {
            "type": "string",
            "required": true,
            "format": "email",
            "description": "User's email address"
          },
          "code": {
            "type": "string",
            "required": true,
            "description": "6-digit verification code sent to email"
          }
        },
        "example": {
          "email": "jane.doe@example.com",
          "code": "123456"
        }
      },
      "resend_verification": {
        "method": "POST",
        "path": "/api/v1/better-auth/resend-verification",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          }
        },
        "body": {
          "email": {
            "type": "string",
            "required": true,
            "format": "email",
            "description": "User's email address"
          }
        },
        "example": {
          "email": "jane.doe@example.com"
        }
      },
      "verify_mfa": {
        "method": "POST",
        "path": "/api/v1/better-auth/verify-mfa",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          }
        },
        "body": {
          "mfaToken": {
            "type": "string",
            "required": true,
            "description": "MFA token returned from login when MFA is enabled"
          },
          "verificationCode": {
            "type": "string",
            "required": true,
            "description": "MFA code from authenticator app"
          }
        },
        "example": {
          "mfaToken": "mfa_abc123xyz",
          "verificationCode": "123456"
        }
      },
      "refresh_token": {
        "method": "POST",
        "path": "/api/v1/better-auth/refresh-token",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          }
        },
        "body": {
          "refreshToken": {
            "type": "string",
            "required": true,
            "description": "Valid refresh token"
          }
        },
        "example": {
          "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        }
      },
      "request_password_reset": {
        "method": "POST",
        "path": "/api/v1/better-auth/request-password-reset",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          }
        },
        "body": {
          "email": {
            "type": "string",
            "required": true,
            "format": "email",
            "description": "User's email address"
          }
        },
        "note": "Always returns success to prevent email enumeration",
        "example": {
          "email": "jane.doe@example.com"
        }
      },
      "reset_password": {
        "method": "POST",
        "path": "/api/v1/better-auth/reset-password",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          }
        },
        "body": {
          "token": {
            "type": "string",
            "required": true,
            "description": "Password reset token from email"
          },
          "newPassword": {
            "type": "string",
            "required": true,
            "minLength": 8,
            "description": "New password"
          }
        },
        "example": {
          "token": "reset_token_abc123xyz",
          "newPassword": "NewSecurePass456!"
        }
      },
      "logout": {
        "method": "POST",
        "path": "/api/v1/better-auth/logout",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          },
          "Authorization": {
            "type": "string",
            "required": false,
            "format": "Bearer <token>",
            "description": "JWT access token (optional, can also use cookie)"
          }
        },
        "body": {
          "token": {
            "type": "string",
            "required": false,
            "description": "Optional token to revoke (can also come from cookie or header)"
          }
        },
        "cookies": {
          "auth_token": {
            "description": "HTTP-only cookie cleared on logout"
          }
        },
        "example": {}
      },
      "setup_mfa": {
        "method": "POST",
        "path": "/api/v1/better-auth/mfa/setup",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          },
          "Authorization": {
            "type": "string",
            "required": true,
            "format": "Bearer <token>",
            "description": "JWT access token"
          }
        },
        "body": {},
        "description": "No body required - initiates MFA setup for authenticated user",
        "example": {}
      },
      "complete_mfa_setup": {
        "method": "POST",
        "path": "/api/v1/better-auth/mfa/verify",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          },
          "Authorization": {
            "type": "string",
            "required": true,
            "format": "Bearer <token>",
            "description": "JWT access token"
          }
        },
        "body": {
          "verificationToken": {
            "type": "string",
            "required": true,
            "description": "Verification token from mfa/setup response"
          },
          "verificationCode": {
            "type": "string",
            "required": true,
            "description": "6-digit code from authenticator app"
          }
        },
        "example": {
          "verificationToken": "verify_token_abc123",
          "verificationCode": "123456"
        }
      },
      "change_password": {
        "method": "POST",
        "path": "/api/v1/better-auth/change-password",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          },
          "Authorization": {
            "type": "string",
            "required": true,
            "format": "Bearer <token>",
            "description": "JWT access token"
          }
        },
        "body": {
          "currentPassword": {
            "type": "string",
            "required": true,
            "description": "User's current password"
          },
          "newPassword": {
            "type": "string",
            "required": true,
            "minLength": 8,
            "description": "New password"
          }
        },
        "example": {
          "currentPassword": "OldSecurePass123!",
          "newPassword": "NewSecurePass456!"
        }
      }
    },
    "biometric_auth_routes": {
      "registration_challenge": {
        "method": "POST",
        "path": "/api/v1/biometric/registration/challenge",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          },
          "Authorization": {
            "type": "string",
            "required": true,
            "format": "Bearer <token>",
            "description": "JWT access token"
          }
        },
        "body": {
          "requireResidentKey": {
            "type": "boolean",
            "required": false,
            "default": false,
            "description": "Whether to require a resident key (device-bound credential)"
          },
          "userVerification": {
            "type": "string",
            "required": false,
            "enum": ["required", "preferred", "discouraged"],
            "default": "preferred",
            "description": "Level of user verification required"
          }
        },
        "example": {
          "requireResidentKey": true,
          "userVerification": "required"
        }
      },
      "registration_complete": {
        "method": "POST",
        "path": "/api/v1/biometric/registration/complete",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          },
          "Authorization": {
            "type": "string",
            "required": true,
            "format": "Bearer <token>",
            "description": "JWT access token"
          }
        },
        "body": {
          "challengeId": {
            "type": "string",
            "required": true,
            "description": "Challenge ID from registration/challenge response"
          },
          "registrationData": {
            "type": "object",
            "required": true,
            "description": "WebAuthn registration response from navigator.credentials.create()",
            "properties": {
              "id": {
                "type": "string",
                "description": "Credential ID"
              },
              "rawId": {
                "type": "string",
                "description": "Base64-encoded raw credential ID"
              },
              "response": {
                "type": "object",
                "properties": {
                  "attestationObject": {
                    "type": "string",
                    "description": "Base64-encoded attestation object"
                  },
                  "clientDataJSON": {
                    "type": "string",
                    "description": "Base64-encoded client data JSON"
                  }
                }
              },
              "type": {
                "type": "string",
                "value": "public-key"
              }
            }
          },
          "backupPin": {
            "type": "string",
            "required": false,
            "minLength": 4,
            "maxLength": 8,
            "description": "Optional backup PIN for fallback authentication"
          }
        },
        "example": {
          "challengeId": "challenge_abc123",
          "registrationData": {
            "id": "credential_id_xyz",
            "rawId": "Y3JlZGVudGlhbF9pZF94eXo=",
            "response": {
              "attestationObject": "base64_encoded_attestation",
              "clientDataJSON": "base64_encoded_client_data"
            },
            "type": "public-key"
          },
          "backupPin": "123456"
        }
      },
      "authentication_challenge": {
        "method": "POST",
        "path": "/api/v1/biometric/authentication/challenge",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          }
        },
        "body": {
          "identifier": {
            "type": "string",
            "required": false,
            "description": "Optional username or email to narrow down credentials"
          }
        },
        "example": {
          "identifier": "john.doe@example.com"
        }
      },
      "authentication_verify": {
        "method": "POST",
        "path": "/api/v1/biometric/authentication/verify",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          },
          "User-Agent": {
            "type": "string",
            "required": false,
            "description": "Used for security logging"
          }
        },
        "body": {
          "challengeId": {
            "type": "string",
            "required": true,
            "description": "Challenge ID from authentication/challenge response"
          },
          "authenticationData": {
            "type": "object",
            "required": true,
            "description": "WebAuthn authentication response from navigator.credentials.get()",
            "properties": {
              "id": {
                "type": "string",
                "description": "Credential ID"
              },
              "rawId": {
                "type": "string",
                "description": "Base64-encoded raw credential ID"
              },
              "response": {
                "type": "object",
                "properties": {
                  "authenticatorData": {
                    "type": "string",
                    "description": "Base64-encoded authenticator data"
                  },
                  "clientDataJSON": {
                    "type": "string",
                    "description": "Base64-encoded client data JSON"
                  },
                  "signature": {
                    "type": "string",
                    "description": "Base64-encoded signature"
                  },
                  "userHandle": {
                    "type": "string",
                    "description": "Base64-encoded user handle"
                  }
                }
              },
              "type": {
                "type": "string",
                "value": "public-key"
              }
            }
          }
        },
        "cookies": {
          "novunt_biometric_token": {
            "description": "HTTP-only cookie set on successful authentication",
            "httpOnly": true,
            "secure": true,
            "maxAge": "30 minutes"
          }
        },
        "example": {
          "challengeId": "challenge_xyz789",
          "authenticationData": {
            "id": "credential_id_xyz",
            "rawId": "Y3JlZGVudGlhbF9pZF94eXo=",
            "response": {
              "authenticatorData": "base64_encoded_auth_data",
              "clientDataJSON": "base64_encoded_client_data",
              "signature": "base64_encoded_signature",
              "userHandle": "base64_encoded_user_handle"
            },
            "type": "public-key"
          }
        }
      },
      "authentication_backup_pin": {
        "method": "POST",
        "path": "/api/v1/biometric/authentication/backup-pin",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          },
          "User-Agent": {
            "type": "string",
            "required": false,
            "description": "Used for security logging"
          }
        },
        "body": {
          "credentialId": {
            "type": "string",
            "required": true,
            "description": "Biometric credential ID"
          },
          "pin": {
            "type": "string",
            "required": true,
            "minLength": 4,
            "maxLength": 8,
            "description": "Backup PIN set during device registration"
          }
        },
        "cookies": {
          "novunt_backup_token": {
            "description": "HTTP-only cookie set on successful PIN authentication",
            "httpOnly": true,
            "secure": true,
            "maxAge": "30 minutes"
          }
        },
        "example": {
          "credentialId": "credential_id_xyz",
          "pin": "123456"
        }
      },
      "get_devices": {
        "method": "GET",
        "path": "/api/v1/biometric/devices",
        "headers": {
          "Authorization": {
            "type": "string",
            "required": true,
            "format": "Bearer <token>",
            "description": "JWT access token"
          }
        },
        "query_parameters": {},
        "body": {},
        "description": "No body or query parameters required",
        "example": {}
      },
      "remove_device": {
        "method": "DELETE",
        "path": "/api/v1/biometric/devices/:deviceId",
        "headers": {
          "Authorization": {
            "type": "string",
            "required": true,
            "format": "Bearer <token>",
            "description": "JWT access token"
          }
        },
        "path_parameters": {
          "deviceId": {
            "type": "string",
            "required": true,
            "description": "Biometric device ID to remove"
          }
        },
        "body": {},
        "example": {
          "path": "/api/v1/biometric/devices/507f1f77bcf86cd799439011"
        }
      },
      "update_settings": {
        "method": "PUT",
        "path": "/api/v1/biometric/settings",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          },
          "Authorization": {
            "type": "string",
            "required": true,
            "format": "Bearer <token>",
            "description": "JWT access token"
          }
        },
        "body": {
          "enabled": {
            "type": "boolean",
            "required": false,
            "description": "Enable/disable biometric authentication"
          },
          "requireUserVerification": {
            "type": "boolean",
            "required": false,
            "description": "Require user verification for biometric auth"
          }
        },
        "example": {
          "enabled": true,
          "requireUserVerification": true
        }
      }
    },
    "social_verification_routes": {
      "visit_platform": {
        "method": "GET",
        "path": "/api/v1/social-media/visit/:platform",
        "headers": {
          "Authorization": {
            "type": "string",
            "required": true,
            "format": "Bearer <token>",
            "description": "JWT access token"
          },
          "Accept": {
            "type": "string",
            "required": false,
            "description": "Set to 'application/json' for JSON response instead of redirect"
          }
        },
        "path_parameters": {
          "platform": {
            "type": "string",
            "required": true,
            "enum": ["facebook", "instagram", "youtube", "tiktok", "telegram"],
            "description": "Social media platform to visit"
          }
        },
        "query_parameters": {
          "json": {
            "type": "string",
            "required": false,
            "enum": ["1"],
            "description": "Set to '1' to get JSON response instead of redirect"
          }
        },
        "description": "Redirects to social media platform and generates verification token",
        "example": {
          "path": "/api/v1/social-media/visit/facebook",
          "query": "?json=1"
        }
      },
      "confirm_platform": {
        "method": "POST",
        "path": "/api/v1/social-media/confirm/:platform",
        "headers": {
          "Content-Type": {
            "type": "string",
            "required": true,
            "value": "application/json"
          },
          "Authorization": {
            "type": "string",
            "required": true,
            "format": "Bearer <token>",
            "description": "JWT access token"
          }
        },
        "path_parameters": {
          "platform": {
            "type": "string",
            "required": true,
            "enum": ["facebook", "instagram", "youtube", "tiktok", "telegram"],
            "description": "Social media platform to confirm"
          }
        },
        "body": {
          "token": {
            "type": "string",
            "required": true,
            "description": "Verification token from visit/:platform response"
          }
        },
        "rate_limiting": {
          "window": "60 seconds",
          "max_attempts": 10,
          "description": "Rate limited to prevent abuse"
        },
        "description": "Confirms platform visit after minimum dwell time requirement",
        "example": {
          "path": "/api/v1/social-media/confirm/facebook",
          "body": {
            "token": "abc123xyz789token"
          }
        }
      }
    },
    "common_headers": {
      "all_routes": {
        "Content-Type": {
          "description": "Required for all POST/PUT/PATCH requests",
          "value": "application/json"
        },
        "User-Agent": {
          "description": "Automatically sent by browsers, used for security logging and device fingerprinting",
          "required": false
        }
      },
      "authenticated_routes": {
        "Authorization": {
          "description": "JWT access token in Bearer format",
          "format": "Bearer <access_token>",
          "required": true
        }
      }
    },
    "password_requirements": {
      "minLength": 8,
      "pattern": "^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{8,}$",
      "requirements": [
        "At least 8 characters long",
        "At least one uppercase letter (A-Z)",
        "At least one lowercase letter (a-z)",
        "At least one digit (0-9)",
        "At least one special character (@, $, !, %, *, ?, &)"
      ]
    },
    "rate_limiting": {
      "registration": {
        "window": "1 hour",
        "max_attempts": 3,
        "routes": ["/api/v1/auth/register", "/api/v1/auth/verify-email", "/api/v1/auth/complete-registration"]
      },
      "login": {
        "window": "15 minutes",
        "max_attempts": 5,
        "routes": ["/api/v1/auth/login", "/api/v1/better-auth/login", "/api/v1/auth/refresh-token"]
      },
      "password_reset": {
        "window": "1 hour",
        "max_attempts": 3,
        "routes": ["/api/v1/auth/reset-password/request", "/api/v1/auth/reset-password"]
      },
      "2fa": {
        "window": "15 minutes",
        "max_attempts": 5,
        "routes": ["/api/v1/auth/verify-2fa", "/api/v1/auth/enable-2fa"]
      },
      "social_confirm": {
        "window": "60 seconds",
        "max_attempts": 10,
        "routes": ["/api/v1/social-media/confirm/:platform"]
      }
    },
    "security_features": {
      "account_lockout": {
        "description": "Account locked after 5 failed login attempts",
        "duration": "15 minutes",
        "affected_routes": ["/api/v1/auth/login"]
      },
      "email_enumeration_prevention": {
        "description": "Generic error messages to prevent user enumeration",
        "affected_routes": [
          "/api/v1/auth/register",
          "/api/v1/auth/reset-password/request",
          "/api/v1/better-auth/request-password-reset"
        ]
      },
      "password_breach_checking": {
        "description": "Passwords checked against known breach databases",
        "affected_routes": ["/api/v1/auth/register", "/api/v1/auth/password"]
      },
      "suspicious_activity_detection": {
        "description": "IP-based fraud detection and device fingerprinting",
        "affected_routes": ["All authentication routes"]
      },
      "token_versioning": {
        "description": "Allows forced logout from all devices by incrementing token version",
        "affected_routes": ["/api/v1/auth/logout-all-devices"]
      }
    },
    "notes": {
      "authentication_flow": [
        "Legacy auth routes use JWT with refresh tokens stored in database",
        "BetterAuth routes use enhanced security with HTTP-only cookies",
        "Biometric routes use WebAuthn/FIDO2 standard for passwordless authentication",
        "All passwords are hashed with bcrypt before storage",
        "Access tokens expire in 15 minutes, refresh tokens in 7 days",
        "Email verification required before login (BetterAuth) or after registration (Legacy)"
      ],
      "development_mode": [
        "In development mode, verification codes are logged to console",
        "Email sending is bypassed if MAIL_PASS is not configured",
        "Error details are included in responses (removed in production)"
      ],
      "social_verification": [
        "Social media routes are for registration bonus verification only",
        "NOT for OAuth social login",
        "Requires minimum dwell time on social platform before confirmation",
        "Used to qualify for 10% registration bonus"
      ]
    }
  }
}
