{
  "version": "1.0.0",
  "generated": "2025-10-12",
  "description": "Complete authentication and authorization documentation for Novunt API",
  "baseUrl": "/api/auth",
  "authenticationSystem": {
    "primary": "BetterAuth (Custom Implementation)",
    "tokenType": "JWT (JSON Web Tokens)",
    "sessionManagement": "Token-based with refresh tokens",
    "passwordHashing": "SHA-256 via BetterAuth utilities",
    "securityFeatures": [
      "Email verification required for new accounts",
      "Multi-factor authentication (MFA) support",
      "Account lockout after 5 failed login attempts (15 minutes)",
      "Password complexity requirements",
      "Token versioning for security",
      "HTTP-only cookies for token storage",
      "Role-based access control (RBAC)"
    ]
  },
  "roles": {
    "user": {
      "description": "Standard user with access to basic platform features",
      "permissions": [
        "View own profile",
        "Manage own wallet",
        "Create stakes",
        "View own transactions",
        "Make deposits/withdrawals",
        "Transfer funds to other users",
        "Update own profile"
      ]
    },
    "admin": {
      "description": "Administrative user with elevated privileges",
      "permissions": [
        "All user permissions",
        "View all users",
        "Manage withdrawal requests",
        "Declare weekly profits",
        "View system statistics",
        "Manage KYC submissions",
        "View all transactions"
      ]
    },
    "superAdmin": {
      "description": "Highest level administrative access",
      "permissions": [
        "All admin permissions",
        "Manage admin users",
        "Modify system settings",
        "Access financial safeguards",
        "Manage registration bonus system",
        "Full system control"
      ]
    }
  },
  "endpoints": {
    "register": {
      "method": "POST",
      "path": "/api/auth/register",
      "authentication": false,
      "description": "Register a new user account",
      "requestBody": {
        "required": true,
        "contentType": "application/json",
        "schema": {
          "email": {
            "type": "string",
            "required": true,
            "format": "email",
            "description": "User's email address",
            "example": "user@example.com",
            "validation": "Must be valid email format, lowercase, trimmed"
          },
          "password": {
            "type": "string",
            "required": true,
            "minLength": 8,
            "description": "User's password",
            "example": "SecurePass123!",
            "validation": "Minimum 8 characters, must contain uppercase, lowercase, number, and special character (@_$!%*?&)"
          },
          "confirmPassword": {
            "type": "string",
            "required": true,
            "description": "Password confirmation",
            "example": "SecurePass123!",
            "validation": "Must match password field"
          },
          "firstName": {
            "type": "string",
            "required": true,
            "description": "User's first name",
            "example": "John"
          },
          "lastName": {
            "type": "string",
            "required": true,
            "description": "User's last name",
            "example": "Doe"
          },
          "username": {
            "type": "string",
            "required": true,
            "description": "Unique username",
            "example": "johndoe123",
            "validation": "Must be unique, trimmed, lowercase"
          },
          "phoneNumber": {
            "type": "string",
            "required": false,
            "description": "User's phone number",
            "example": "+1234567890"
          },
          "countryCode": {
            "type": "string",
            "required": false,
            "description": "Country code",
            "example": "+1"
          },
          "referralCode": {
            "type": "string",
            "required": false,
            "description": "Referral code from existing user",
            "example": "REF123ABC"
          }
        }
      },
      "responses": {
        "201": {
          "description": "User registered successfully",
          "schema": {
            "success": true,
            "message": "User registered successfully. Please check your email for verification code.",
            "data": {
              "user": {
                "_id": "ObjectId",
                "email": "string",
                "username": "string",
                "fname": "string",
                "lname": "string",
                "role": "user",
                "emailVerified": false,
                "isActive": true,
                "createdAt": "Date",
                "rank": "Stakeholder"
              },
              "requiresEmailVerification": true,
              "message": "A 6-digit verification code has been sent to your email"
            }
          }
        },
        "400": {
          "description": "Validation error or registration failed",
          "schema": {
            "success": false,
            "message": "string",
            "error": {
              "code": "VALIDATION_ERROR | REGISTRATION_FAILED | EMAIL_EXISTS | USERNAME_EXISTS",
              "message": "Descriptive error message"
            }
          },
          "possibleErrors": [
            {
              "code": "VALIDATION_ERROR",
              "message": "Email, password, first name, last name, and username are required"
            },
            {
              "code": "VALIDATION_ERROR",
              "message": "Passwords do not match"
            },
            {
              "code": "EMAIL_EXISTS",
              "message": "Email already registered"
            },
            {
              "code": "USERNAME_EXISTS",
              "message": "Username already taken"
            },
            {
              "code": "INVALID_REFERRAL_CODE",
              "message": "Invalid or expired referral code"
            }
          ]
        },
        "500": {
          "description": "Server error",
          "schema": {
            "success": false,
            "message": "An error occurred during registration",
            "error": {
              "code": "SERVER_ERROR",
              "message": "Internal server error details"
            }
          }
        }
      }
    },
    "verifyEmail": {
      "method": "POST",
      "path": "/api/auth/verify-email",
      "authentication": false,
      "description": "Verify user email with 6-digit code",
      "requestBody": {
        "required": true,
        "contentType": "application/json",
        "schema": {
          "email": {
            "type": "string",
            "required": true,
            "description": "User's email address",
            "example": "user@example.com"
          },
          "code": {
            "type": "string",
            "required": true,
            "description": "6-digit verification code",
            "example": "123456",
            "validation": "Must be 6 digits"
          }
        }
      },
      "responses": {
        "200": {
          "description": "Email verified successfully",
          "schema": {
            "success": true,
            "message": "Email verified successfully",
            "data": {
              "verified": true,
              "user": {
                "_id": "ObjectId",
                "email": "string",
                "emailVerified": true
              }
            }
          }
        },
        "400": {
          "description": "Invalid or expired code",
          "schema": {
            "success": false,
            "message": "string",
            "error": {
              "code": "INVALID_CODE | CODE_EXPIRED",
              "message": "Descriptive error message"
            }
          }
        }
      }
    },
    "resendVerification": {
      "method": "POST",
      "path": "/api/auth/resend-verification",
      "authentication": false,
      "description": "Resend email verification code",
      "requestBody": {
        "required": true,
        "contentType": "application/json",
        "schema": {
          "email": {
            "type": "string",
            "required": true,
            "description": "User's email address",
            "example": "user@example.com"
          }
        }
      },
      "responses": {
        "200": {
          "description": "Verification code resent",
          "schema": {
            "success": true,
            "message": "Verification code sent successfully",
            "data": {
              "sent": true,
              "expiresIn": "15 minutes"
            }
          }
        },
        "400": {
          "description": "Error resending code",
          "schema": {
            "success": false,
            "message": "string",
            "error": {
              "code": "USER_NOT_FOUND | ALREADY_VERIFIED | RATE_LIMIT_EXCEEDED",
              "message": "Descriptive error message"
            }
          }
        }
      }
    },
    "login": {
      "method": "POST",
      "path": "/api/auth/login",
      "authentication": false,
      "description": "Login with email and password",
      "requestBody": {
        "required": true,
        "contentType": "application/json",
        "schema": {
          "email": {
            "type": "string",
            "required": true,
            "description": "User's email address",
            "example": "user@example.com"
          },
          "password": {
            "type": "string",
            "required": true,
            "description": "User's password",
            "example": "SecurePass123!"
          }
        }
      },
      "responses": {
        "200": {
          "description": "Login successful or MFA required",
          "schemas": [
            {
              "case": "Login successful (no MFA)",
              "schema": {
                "success": true,
                "message": "Login successful",
                "data": {
                  "token": "JWT access token string",
                  "refreshToken": "Refresh token string",
                  "user": {
                    "_id": "ObjectId",
                    "email": "string",
                    "username": "string",
                    "fname": "string",
                    "lname": "string",
                    "role": "user | admin | superAdmin",
                    "emailVerified": true,
                    "twoFAEnabled": false,
                    "rank": "Stakeholder",
                    "isActive": true
                  }
                }
              },
              "cookies": {
                "auth_token": {
                  "value": "JWT token",
                  "httpOnly": true,
                  "secure": "true in production",
                  "maxAge": "24 hours"
                }
              }
            },
            {
              "case": "MFA required",
              "schema": {
                "success": true,
                "message": "MFA verification required",
                "data": {
                  "mfaRequired": true,
                  "mfaToken": "Temporary MFA token",
                  "user": {
                    "_id": "ObjectId",
                    "email": "string"
                  }
                }
              }
            }
          ]
        },
        "401": {
          "description": "Authentication failed",
          "schema": {
            "success": false,
            "message": "Login failed",
            "error": {
              "code": "INVALID_CREDENTIALS | ACCOUNT_LOCKED | INCORRECT_PASSWORD",
              "message": "Descriptive error message"
            }
          },
          "possibleErrors": [
            {
              "code": "INVALID_CREDENTIALS",
              "message": "Invalid email or password"
            },
            {
              "code": "ACCOUNT_LOCKED",
              "message": "Account locked due to multiple failed login attempts. Try again in 15 minutes"
            }
          ]
        },
        "403": {
          "description": "Email not verified",
          "schema": {
            "success": false,
            "message": "Please verify your email address before logging in.",
            "error": {
              "code": "EMAIL_NOT_VERIFIED",
              "message": "Please verify your email address before logging in."
            }
          }
        },
        "400": {
          "description": "Validation error",
          "schema": {
            "success": false,
            "message": "Email and password are required",
            "error": {
              "code": "VALIDATION_ERROR",
              "message": "Email and password are required"
            }
          }
        }
      },
      "securityNotes": [
        "Account locks after 5 failed attempts for 15 minutes",
        "Failed login attempts reset after 24 hours of inactivity",
        "Security events are logged for all login attempts"
      ]
    },
    "verifyMFA": {
      "method": "POST",
      "path": "/api/auth/verify-mfa",
      "authentication": false,
      "description": "Verify MFA code during login",
      "requestBody": {
        "required": true,
        "contentType": "application/json",
        "schema": {
          "mfaToken": {
            "type": "string",
            "required": true,
            "description": "Temporary MFA token from login response",
            "example": "mfa_abc123xyz"
          },
          "verificationCode": {
            "type": "string",
            "required": true,
            "description": "6-digit code from authenticator app",
            "example": "123456"
          }
        }
      },
      "responses": {
        "200": {
          "description": "MFA verification successful",
          "schema": {
            "success": true,
            "message": "MFA verification successful",
            "data": {
              "token": "JWT access token",
              "refreshToken": "Refresh token",
              "user": {
                "_id": "ObjectId",
                "email": "string",
                "username": "string",
                "role": "string",
                "twoFAEnabled": true
              }
            }
          },
          "cookies": {
            "auth_token": "JWT token set as HTTP-only cookie"
          }
        },
        "401": {
          "description": "MFA verification failed",
          "schema": {
            "success": false,
            "message": "MFA verification failed",
            "error": {
              "code": "MFA_VERIFICATION_FAILED | INVALID_CODE",
              "message": "Invalid verification code"
            }
          }
        }
      }
    },
    "setupMFA": {
      "method": "POST",
      "path": "/api/auth/mfa/setup",
      "authentication": true,
      "authorizationRoles": ["user", "admin", "superAdmin"],
      "description": "Initiate MFA setup for authenticated user",
      "requestBody": {
        "required": false,
        "description": "No body required, user ID extracted from auth token"
      },
      "responses": {
        "200": {
          "description": "MFA setup initiated",
          "schema": {
            "success": true,
            "message": "MFA setup initiated",
            "data": {
              "setupDetails": {
                "secret": "Base32 encoded secret",
                "qrCode": "Data URL for QR code image",
                "manualEntry": "Secret for manual entry"
              },
              "verificationToken": "Token for completing setup"
            }
          }
        },
        "401": {
          "description": "Not authenticated",
          "schema": {
            "success": false,
            "message": "You must be authenticated to set up MFA",
            "error": {
              "code": "AUTH_REQUIRED",
              "message": "Authentication required"
            }
          }
        }
      }
    },
    "completeMFASetup": {
      "method": "POST",
      "path": "/api/auth/mfa/verify",
      "authentication": true,
      "authorizationRoles": ["user", "admin", "superAdmin"],
      "description": "Complete MFA setup by verifying code",
      "requestBody": {
        "required": true,
        "contentType": "application/json",
        "schema": {
          "verificationToken": {
            "type": "string",
            "required": true,
            "description": "Token from MFA setup response"
          },
          "verificationCode": {
            "type": "string",
            "required": true,
            "description": "6-digit code from authenticator app",
            "example": "123456"
          }
        }
      },
      "responses": {
        "200": {
          "description": "MFA enabled successfully",
          "schema": {
            "success": true,
            "message": "MFA enabled successfully",
            "data": {
              "mfaEnabled": true,
              "backupCodes": ["code1", "code2", "..."]
            }
          }
        },
        "400": {
          "description": "Verification failed",
          "schema": {
            "success": false,
            "message": "MFA setup verification failed",
            "error": {
              "code": "INVALID_CODE | VERIFICATION_FAILED",
              "message": "Descriptive error message"
            }
          }
        }
      }
    },
    "refreshToken": {
      "method": "POST",
      "path": "/api/auth/refresh-token",
      "authentication": false,
      "description": "Refresh an expired access token using refresh token",
      "requestBody": {
        "required": true,
        "contentType": "application/json",
        "schema": {
          "refreshToken": {
            "type": "string",
            "required": true,
            "description": "Valid refresh token",
            "example": "refresh_token_string"
          }
        }
      },
      "responses": {
        "200": {
          "description": "Token refreshed successfully",
          "schema": {
            "success": true,
            "message": "Token refreshed successfully",
            "data": {
              "token": "New JWT access token",
              "user": {
                "_id": "ObjectId",
                "email": "string",
                "username": "string"
              }
            }
          },
          "cookies": {
            "auth_token": "New JWT token set as HTTP-only cookie"
          }
        },
        "401": {
          "description": "Token refresh failed",
          "schema": {
            "success": false,
            "message": "Token refresh failed",
            "error": {
              "code": "TOKEN_REFRESH_FAILED | INVALID_REFRESH_TOKEN | TOKEN_EXPIRED",
              "message": "Descriptive error message"
            }
          }
        }
      }
    },
    "logout": {
      "method": "POST",
      "path": "/api/auth/logout",
      "authentication": true,
      "authorizationRoles": ["user", "admin", "superAdmin"],
      "description": "Logout and revoke current session",
      "requestBody": {
        "required": false,
        "description": "Token extracted from cookie or Authorization header"
      },
      "responses": {
        "200": {
          "description": "Logout successful",
          "schema": {
            "success": true,
            "message": "Logout successful"
          },
          "cookies": {
            "auth_token": "Cleared"
          }
        },
        "500": {
          "description": "Server error during logout",
          "schema": {
            "success": false,
            "message": "An error occurred during logout",
            "error": {
              "code": "SERVER_ERROR",
              "message": "Error details"
            }
          }
        }
      }
    },
    "requestPasswordReset": {
      "method": "POST",
      "path": "/api/auth/request-password-reset",
      "authentication": false,
      "description": "Request password reset link",
      "requestBody": {
        "required": true,
        "contentType": "application/json",
        "schema": {
          "email": {
            "type": "string",
            "required": true,
            "format": "email",
            "description": "User's registered email address",
            "example": "user@example.com"
          }
        }
      },
      "responses": {
        "200": {
          "description": "Reset email sent (always returns success for security)",
          "schema": {
            "success": true,
            "message": "If this email exists, a password reset link has been sent",
            "data": {
              "emailSent": true
            }
          }
        },
        "400": {
          "description": "Validation error",
          "schema": {
            "success": false,
            "message": "Email is required",
            "error": {
              "code": "VALIDATION_ERROR",
              "message": "Email is required"
            }
          }
        }
      }
    },
    "resetPassword": {
      "method": "POST",
      "path": "/api/auth/reset-password",
      "authentication": false,
      "description": "Reset password using reset token",
      "requestBody": {
        "required": true,
        "contentType": "application/json",
        "schema": {
          "resetToken": {
            "type": "string",
            "required": true,
            "description": "Token from reset email",
            "example": "reset_token_abc123"
          },
          "newPassword": {
            "type": "string",
            "required": true,
            "minLength": 8,
            "description": "New password",
            "example": "NewSecurePass123!",
            "validation": "Same password complexity rules as registration"
          },
          "confirmPassword": {
            "type": "string",
            "required": true,
            "description": "Password confirmation",
            "example": "NewSecurePass123!"
          }
        }
      },
      "responses": {
        "200": {
          "description": "Password reset successful",
          "schema": {
            "success": true,
            "message": "Password reset successfully",
            "data": {
              "passwordReset": true
            }
          }
        },
        "400": {
          "description": "Validation or token error",
          "schema": {
            "success": false,
            "message": "string",
            "error": {
              "code": "INVALID_TOKEN | TOKEN_EXPIRED | PASSWORDS_DONT_MATCH | VALIDATION_ERROR",
              "message": "Descriptive error message"
            }
          }
        }
      }
    },
    "changePassword": {
      "method": "POST",
      "path": "/api/auth/change-password",
      "authentication": true,
      "authorizationRoles": ["user", "admin", "superAdmin"],
      "description": "Change password for authenticated user",
      "requestBody": {
        "required": true,
        "contentType": "application/json",
        "schema": {
          "currentPassword": {
            "type": "string",
            "required": true,
            "description": "Current password",
            "example": "OldPass123!"
          },
          "newPassword": {
            "type": "string",
            "required": true,
            "minLength": 8,
            "description": "New password",
            "example": "NewSecurePass123!"
          },
          "confirmNewPassword": {
            "type": "string",
            "required": true,
            "description": "New password confirmation",
            "example": "NewSecurePass123!"
          }
        }
      },
      "responses": {
        "200": {
          "description": "Password changed successfully",
          "schema": {
            "success": true,
            "message": "Password changed successfully",
            "data": {
              "passwordChanged": true
            }
          }
        },
        "400": {
          "description": "Validation error",
          "schema": {
            "success": false,
            "message": "string",
            "error": {
              "code": "VALIDATION_ERROR | PASSWORDS_DONT_MATCH",
              "message": "Descriptive error message"
            }
          }
        },
        "401": {
          "description": "Current password incorrect",
          "schema": {
            "success": false,
            "message": "Current password is incorrect",
            "error": {
              "code": "INCORRECT_PASSWORD",
              "message": "Current password is incorrect"
            }
          }
        }
      }
    }
  },
  "middleware": {
    "betterAuthMiddleware": {
      "description": "Main authentication middleware that validates JWT tokens and loads user data",
      "usage": "Applied to all protected routes",
      "functionality": [
        "Extracts token from Authorization header (Bearer token) or auth_token cookie",
        "Verifies token signature and expiration",
        "Loads user from database using userId from token",
        "Checks if user account is active",
        "Checks if MFA is required and completed",
        "Attaches user object to request (req.user)",
        "Attaches token to request (req.token)",
        "Logs security events for suspicious activity"
      ],
      "tokenSources": [
        "Authorization: Bearer <token> header",
        "auth_token HTTP-only cookie"
      ],
      "errorResponses": {
        "401_AUTH_REQUIRED": {
          "code": "AUTH_REQUIRED",
          "message": "Valid authentication token is required",
          "httpStatus": 401
        },
        "401_INVALID_TOKEN": {
          "code": "INVALID_TOKEN",
          "message": "The provided authentication token is invalid or expired",
          "httpStatus": 401
        },
        "404_USER_NOT_FOUND": {
          "code": "USER_NOT_FOUND",
          "message": "The user associated with this token does not exist",
          "httpStatus": 404
        },
        "403_ACCOUNT_INACTIVE": {
          "code": "ACCOUNT_INACTIVE",
          "message": "This account has been deactivated. Please contact support.",
          "httpStatus": 403
        },
        "403_MFA_REQUIRED": {
          "code": "MFA_REQUIRED",
          "message": "Multi-factor authentication is required to access this resource",
          "httpStatus": 403
        },
        "500_AUTH_ERROR": {
          "code": "AUTH_ERROR",
          "message": "An error occurred during authentication",
          "httpStatus": 500
        }
      }
    },
    "requireRole": {
      "description": "Authorization middleware that restricts access based on user roles",
      "usage": "Applied after betterAuthMiddleware for role-specific routes",
      "parameters": {
        "roles": {
          "type": "string[]",
          "description": "Array of allowed roles",
          "example": ["admin", "superAdmin"]
        }
      },
      "functionality": [
        "Checks if user is authenticated",
        "Verifies user's role is in allowed roles array",
        "Returns 403 if role not authorized"
      ],
      "errorResponses": {
        "401_AUTH_REQUIRED": {
          "code": "AUTH_REQUIRED",
          "message": "You must be logged in to access this resource",
          "httpStatus": 401
        },
        "403_INSUFFICIENT_PERMISSIONS": {
          "code": "INSUFFICIENT_PERMISSIONS",
          "message": "You do not have permission to access this resource",
          "httpStatus": 403
        }
      },
      "examples": [
        {
          "code": "router.get('/admin/users', betterAuthMiddleware, requireRole(['admin', 'superAdmin']), getAllUsers)"
        }
      ]
    }
  },
  "tokenStructure": {
    "accessToken": {
      "type": "JWT",
      "algorithm": "HS256",
      "expiresIn": "24 hours",
      "payload": {
        "userId": "User's ObjectId as string",
        "email": "User's email",
        "role": "User's role",
        "mfaCompleted": "Boolean - whether MFA was completed",
        "iat": "Issued at timestamp",
        "exp": "Expiration timestamp"
      },
      "storage": [
        "Authorization header: Bearer <token>",
        "HTTP-only cookie: auth_token"
      ]
    },
    "refreshToken": {
      "type": "JWT",
      "expiresIn": "7 days",
      "usage": "Used to obtain new access token when expired",
      "storage": "Client-side (not HTTP-only)"
    },
    "mfaToken": {
      "type": "Temporary token",
      "expiresIn": "5 minutes",
      "usage": "Temporary token issued during login when MFA is required"
    }
  },
  "passwordRequirements": {
    "minLength": 8,
    "pattern": "^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@_$!%*?&])[A-Za-z\\d@_$!%*?&]{8,}$",
    "rules": [
      "At least 8 characters long",
      "At least one uppercase letter",
      "At least one lowercase letter",
      "At least one digit",
      "At least one special character from: @ _ $ ! % * ? &"
    ]
  },
  "securityFeatures": {
    "emailVerification": {
      "description": "Required for all new accounts before login",
      "codeLength": 6,
      "codeExpiration": "15 minutes",
      "resendLimit": "Rate limited to prevent abuse"
    },
    "accountLockout": {
      "description": "Automatic lockout after failed login attempts",
      "failedAttemptsThreshold": 5,
      "lockoutDuration": "15 minutes",
      "resetPeriod": "24 hours of inactivity resets counter"
    },
    "mfaSupport": {
      "description": "Optional multi-factor authentication using TOTP",
      "type": "Time-based One-Time Password (TOTP)",
      "app": "Google Authenticator compatible",
      "backupCodes": "Provided during setup"
    },
    "tokenVersioning": {
      "description": "Allows invalidating all user tokens by incrementing version",
      "usage": "For security incidents or password changes"
    },
    "httpOnlyCookies": {
      "description": "Tokens stored in HTTP-only cookies to prevent XSS attacks",
      "secure": "True in production (HTTPS only)"
    }
  },
  "commonErrors": {
    "VALIDATION_ERROR": {
      "httpStatus": 400,
      "description": "Request validation failed",
      "causes": [
        "Missing required fields",
        "Invalid email format",
        "Password too short",
        "Passwords don't match"
      ]
    },
    "EMAIL_EXISTS": {
      "httpStatus": 400,
      "description": "Email already registered in the system"
    },
    "USERNAME_EXISTS": {
      "httpStatus": 400,
      "description": "Username already taken"
    },
    "INVALID_CREDENTIALS": {
      "httpStatus": 401,
      "description": "Incorrect email or password"
    },
    "EMAIL_NOT_VERIFIED": {
      "httpStatus": 403,
      "description": "User must verify email before logging in"
    },
    "ACCOUNT_LOCKED": {
      "httpStatus": 401,
      "description": "Too many failed login attempts",
      "resolution": "Wait 15 minutes or contact support"
    },
    "AUTH_REQUIRED": {
      "httpStatus": 401,
      "description": "Authentication token required but not provided"
    },
    "INVALID_TOKEN": {
      "httpStatus": 401,
      "description": "Token is invalid, malformed, or expired"
    },
    "MFA_REQUIRED": {
      "httpStatus": 403,
      "description": "MFA verification required to complete authentication"
    },
    "INSUFFICIENT_PERMISSIONS": {
      "httpStatus": 403,
      "description": "User role does not have access to this resource"
    }
  },
  "frontendIntegrationGuide": {
    "authenticationFlow": [
      "1. User registers via POST /api/auth/register",
      "2. System sends 6-digit code to email",
      "3. User submits code via POST /api/auth/verify-email",
      "4. User logs in via POST /api/auth/login",
      "5. If MFA enabled, submit code via POST /api/auth/verify-mfa",
      "6. Store accessToken and refreshToken securely",
      "7. Include token in Authorization header for protected requests",
      "8. When token expires, refresh via POST /api/auth/refresh-token",
      "9. On logout, call POST /api/auth/logout"
    ],
    "tokenStorage": {
      "recommended": "Use HTTP-only cookies (automatic with credentials: 'include')",
      "alternative": "Store in memory or sessionStorage (never localStorage for security)",
      "implementation": "Backend sets auth_token cookie automatically"
    },
    "requestHeaders": {
      "authorization": "Bearer <access_token>",
      "contentType": "application/json"
    },
    "errorHandling": {
      "401": "Redirect to login page",
      "403_EMAIL_NOT_VERIFIED": "Show email verification screen",
      "403_MFA_REQUIRED": "Show MFA input screen",
      "403_INSUFFICIENT_PERMISSIONS": "Show access denied message",
      "500": "Show generic error message"
    },
    "roleBasedUI": {
      "user": "Show basic dashboard, wallet, stakes",
      "admin": "Show admin panel, withdrawal approvals, user management",
      "superAdmin": "Show all admin features plus system settings"
    }
  }
}
