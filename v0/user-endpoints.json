{
  "version": "1.0.0",
  "generated": "2025-10-12",
  "description": "Complete user management endpoints documentation for Novunt API",
  "baseUrl": "/api/users",
  "endpoints": {
    "getAllUsers": {
      "method": "GET",
      "path": "/api/users/",
      "authentication": true,
      "authorization": {
        "requiredRoles": ["admin", "superAdmin"],
        "middleware": ["authenticateUser", "checkAdmin"]
      },
      "description": "Get all active users in the system",
      "queryParameters": null,
      "requestBody": null,
      "responses": {
        "200": {
          "description": "Successfully retrieved all users",
          "contentType": "application/json",
          "schema": {
            "type": "array",
            "items": {
              "_id": "ObjectId",
              "fname": "string",
              "lname": "string",
              "username": "string",
              "email": "string",
              "role": "user | admin | superAdmin",
              "rank": "string",
              "emailVerified": "boolean",
              "twoFAEnabled": "boolean",
              "phoneNumber": "string | undefined",
              "countryCode": "string | undefined",
              "referralCode": "string | undefined",
              "directDownlines": "ObjectId[]",
              "personalStake": "number",
              "teamStake": "number",
              "rankQualificationStatus": "qualified | not_qualified | pending_verification",
              "rankPoolQualified": "boolean",
              "redistributionPoolQualified": "boolean",
              "isActive": "boolean",
              "createdAt": "Date",
              "updatedAt": "Date"
            },
            "note": "Password field is excluded from response"
          },
          "example": [
            {
              "_id": "507f1f77bcf86cd799439011",
              "fname": "John",
              "lname": "Doe",
              "username": "johndoe",
              "email": "john@example.com",
              "role": "user",
              "rank": "Stakeholder",
              "emailVerified": true,
              "twoFAEnabled": false,
              "referralCode": "JOHN123",
              "personalStake": 500,
              "teamStake": 2000,
              "rankQualificationStatus": "qualified",
              "rankPoolQualified": true,
              "redistributionPoolQualified": false,
              "isActive": true,
              "createdAt": "2025-01-15T10:30:00Z",
              "updatedAt": "2025-10-12T08:20:00Z"
            }
          ]
        },
        "401": {
          "description": "Not authenticated",
          "schema": {
            "message": "Authentication required"
          }
        },
        "403": {
          "description": "Insufficient permissions",
          "schema": {
            "message": "Admin access required"
          }
        },
        "500": {
          "description": "Server error",
          "schema": {
            "message": "Error retrieving users",
            "error": "Error details"
          }
        }
      },
      "securityNotes": [
        "Password field is automatically excluded from all responses",
        "Only returns active users (isActive: true)",
        "Requires admin or superAdmin role"
      ]
    },
    "getAllAdmin": {
      "method": "GET",
      "path": "/api/users/admin",
      "authentication": true,
      "authorization": {
        "requiredRoles": ["admin", "superAdmin"],
        "middleware": ["authenticateUser", "checkAdmin"]
      },
      "description": "Get all active users with admin role",
      "queryParameters": null,
      "requestBody": null,
      "responses": {
        "200": {
          "description": "Successfully retrieved all administrators",
          "contentType": "application/json",
          "schema": {
            "type": "array",
            "items": "User object (same structure as getAllUsers)",
            "filter": "role === 'admin' && isActive === true"
          },
          "example": [
            {
              "_id": "507f1f77bcf86cd799439012",
              "fname": "Admin",
              "lname": "User",
              "username": "adminuser",
              "email": "admin@example.com",
              "role": "admin",
              "isActive": true,
              "createdAt": "2025-01-10T09:00:00Z"
            }
          ]
        },
        "401": {
          "description": "Not authenticated"
        },
        "403": {
          "description": "Insufficient permissions"
        },
        "500": {
          "description": "Server error",
          "schema": {
            "message": "Error retrieving administrators",
            "error": "Error details"
          }
        }
      }
    },
    "searchUsersByUsername": {
      "method": "GET",
      "path": "/api/users/search",
      "authentication": true,
      "authorization": {
        "requiredRoles": ["user", "admin", "superAdmin"],
        "middleware": ["authenticateUser"]
      },
      "description": "Search for users by username (for P2P transfers). Case-insensitive partial matching.",
      "queryParameters": {
        "query": {
          "type": "string",
          "required": true,
          "minLength": 2,
          "description": "Username search query (minimum 2 characters)",
          "example": "john"
        }
      },
      "requestBody": null,
      "businessLogic": {
        "searchBehavior": "Case-insensitive regex match on username",
        "excludes": "Current user is excluded from results",
        "roleFilter": "Only searches users with role='user', excludes admins",
        "statusFilter": "Only returns active users (isActive=true)",
        "emailMasking": "Emails are masked based on system setting 'mask_email_in_search' (default: true)",
        "resultLimit": "Limited by system setting 'max_search_results' (default: 10)",
        "systemSettings": [
          "enable_username_search (boolean, default: true) - Enable/disable search feature",
          "mask_email_in_search (boolean, default: true) - Mask email addresses in results",
          "max_search_results (number, default: 10) - Maximum results to return"
        ]
      },
      "responses": {
        "200": {
          "description": "Search completed successfully",
          "schema": {
            "message": "User search completed successfully",
            "results": [
              {
                "_id": "ObjectId",
                "username": "string",
                "email": "string (possibly masked)",
                "fullName": "string",
                "memberSince": "string (YYYY-MM-DD format)"
              }
            ],
            "totalFound": "number",
            "query": "string (the trimmed search query)"
          },
          "example": {
            "message": "User search completed successfully",
            "results": [
              {
                "_id": "507f1f77bcf86cd799439011",
                "username": "johndoe",
                "email": "j****e@example.com",
                "fullName": "John Doe",
                "memberSince": "2025-01-15"
              },
              {
                "_id": "507f1f77bcf86cd799439013",
                "username": "johnsmith",
                "email": "j*******h@example.com",
                "fullName": "John Smith",
                "memberSince": "2025-02-20"
              }
            ],
            "totalFound": 2,
            "query": "john"
          }
        },
        "400": {
          "description": "Invalid search query",
          "schema": {
            "message": "Search query must be at least 2 characters long"
          }
        },
        "401": {
          "description": "Not authenticated",
          "schema": {
            "message": "Authentication required"
          }
        },
        "403": {
          "description": "Search feature disabled",
          "schema": {
            "message": "Username search is currently disabled"
          }
        },
        "500": {
          "description": "Server error",
          "schema": {
            "message": "Error searching users",
            "error": "Error details"
          }
        }
      },
      "emailMaskingLogic": {
        "description": "Email masking preserves first and last character of username",
        "algorithm": "username[0] + '*'.repeat(length-2) + username[last] + '@' + domain",
        "examples": [
          {
            "original": "john@example.com",
            "masked": "j**n@example.com"
          },
          {
            "original": "alice@example.com",
            "masked": "a***e@example.com"
          },
          {
            "original": "a@example.com",
            "masked": "a@example.com"
          }
        ]
      }
    },
    "getUserById": {
      "method": "GET",
      "path": "/api/users/user/:id",
      "authentication": true,
      "authorization": {
        "requiredRoles": ["user", "admin", "superAdmin"],
        "middleware": ["authenticateUser"]
      },
      "description": "Get a specific user by their ID",
      "pathParameters": {
        "id": {
          "type": "string (ObjectId)",
          "required": true,
          "description": "User's MongoDB ObjectId",
          "example": "507f1f77bcf86cd799439011"
        }
      },
      "requestBody": null,
      "responses": {
        "200": {
          "description": "User found and returned",
          "schema": {
            "type": "object",
            "description": "User object (same structure as getAllUsers response item)",
            "note": "Password field excluded"
          },
          "example": {
            "_id": "507f1f77bcf86cd799439011",
            "fname": "John",
            "lname": "Doe",
            "username": "johndoe",
            "email": "john@example.com",
            "role": "user",
            "rank": "Associate Stakeholder",
            "emailVerified": true,
            "twoFAEnabled": false,
            "personalStake": 500,
            "teamStake": 1200,
            "isActive": true,
            "createdAt": "2025-01-15T10:30:00Z",
            "updatedAt": "2025-10-12T08:20:00Z"
          }
        },
        "404": {
          "description": "User not found",
          "schema": {
            "message": "User not found"
          }
        },
        "500": {
          "description": "Server error",
          "schema": {
            "message": "Error retrieving user",
            "error": "Error details"
          }
        }
      },
      "securityNotes": [
        "Any authenticated user can view any user profile",
        "Password is always excluded from response",
        "No validation if requester is viewing their own profile or another's"
      ]
    },
    "getAdminById": {
      "method": "GET",
      "path": "/api/users/admin/:id",
      "authentication": true,
      "authorization": {
        "requiredRoles": ["admin", "superAdmin"],
        "middleware": ["authenticateUser", "checkAdmin"]
      },
      "description": "Get a specific admin user by ID",
      "pathParameters": {
        "id": {
          "type": "string (ObjectId)",
          "required": true,
          "description": "Admin user's MongoDB ObjectId",
          "example": "507f1f77bcf86cd799439012"
        }
      },
      "requestBody": null,
      "responses": {
        "200": {
          "description": "Admin found and returned",
          "schema": {
            "type": "object",
            "description": "Admin user object",
            "filter": "role === 'admin' && isActive === true"
          }
        },
        "400": {
          "description": "Invalid user ID format",
          "schema": {
            "message": "Invalid user ID"
          }
        },
        "404": {
          "description": "Admin not found",
          "schema": {
            "message": "Admin not found"
          }
        },
        "500": {
          "description": "Server error",
          "schema": {
            "message": "Error retrieving admin",
            "error": "Error details"
          }
        }
      },
      "validations": [
        "Validates that ID is a valid MongoDB ObjectId",
        "Checks that user has role='admin' and isActive=true"
      ]
    },
    "updateUser": {
      "method": "PATCH",
      "path": "/api/users/:id",
      "authentication": true,
      "authorization": {
        "requiredRoles": ["admin", "superAdmin"],
        "middleware": ["authenticateUser", "require2FA", "checkAdmin"]
      },
      "description": "Update user profile information. Requires 2FA if enabled for admin.",
      "pathParameters": {
        "id": {
          "type": "string (ObjectId)",
          "required": true,
          "description": "User's MongoDB ObjectId to update",
          "example": "507f1f77bcf86cd799439011"
        }
      },
      "requestBody": {
        "required": true,
        "contentType": "application/json",
        "description": "Partial user object with fields to update",
        "allowedFields": [
          "fname",
          "lname",
          "username",
          "email",
          "password",
          "phoneNumber",
          "countryCode",
          "profilePicture",
          "twoFAEnabled"
        ],
        "restrictedFields": [
          "role (automatically removed, cannot be updated via this endpoint)"
        ],
        "schema": {
          "fname": {
            "type": "string",
            "required": false,
            "description": "First name"
          },
          "lname": {
            "type": "string",
            "required": false,
            "description": "Last name"
          },
          "username": {
            "type": "string",
            "required": false,
            "description": "Username (must be unique)"
          },
          "email": {
            "type": "string",
            "required": false,
            "description": "Email address (must be unique and valid format)"
          },
          "password": {
            "type": "string",
            "required": false,
            "description": "New password (will be hashed automatically)"
          },
          "phoneNumber": {
            "type": "string",
            "required": false
          },
          "countryCode": {
            "type": "string",
            "required": false
          },
          "profilePicture": {
            "type": "string",
            "required": false,
            "description": "URL to profile picture"
          }
        },
        "example": {
          "fname": "Jane",
          "lname": "Smith",
          "phoneNumber": "+1234567890"
        }
      },
      "responses": {
        "200": {
          "description": "User updated successfully",
          "schema": {
            "message": "User profile updated successfully",
            "data": {
              "type": "object",
              "description": "Updated user object (password excluded)"
            }
          },
          "example": {
            "message": "User profile updated successfully",
            "data": {
              "_id": "507f1f77bcf86cd799439011",
              "fname": "Jane",
              "lname": "Smith",
              "username": "janesmith",
              "email": "jane@example.com",
              "phoneNumber": "+1234567890",
              "updatedAt": "2025-10-12T10:45:00Z"
            }
          }
        },
        "400": {
          "description": "Invalid user ID",
          "schema": {
            "message": "Invalid user ID"
          }
        },
        "404": {
          "description": "User not found or inactive",
          "schema": {
            "message": "User not found or inactive"
          }
        },
        "500": {
          "description": "Server error",
          "schema": {
            "message": "Error updating user"
          }
        }
      },
      "businessLogic": {
        "passwordHandling": "If password is provided, it's automatically hashed with bcrypt (10 rounds)",
        "roleProtection": "Role field is deleted from request body to prevent unauthorized role changes",
        "registrationBonus": "After update, checks if profile changes affect registration bonus eligibility",
        "validations": [
          "User must exist and be active (isActive: true)",
          "User ID must be valid MongoDB ObjectId"
        ]
      },
      "securityNotes": [
        "Requires 2FA verification if admin has 2FA enabled",
        "Role cannot be changed via this endpoint (use promoteToAdmin/demoteToUser)",
        "Password is automatically hashed before storage",
        "Updates trigger registration bonus profile completion check"
      ]
    },
    "updateProfilePicture": {
      "method": "PATCH",
      "path": "/api/users/user/:id/profile-picture",
      "authentication": true,
      "authorization": {
        "requiredRoles": ["user", "admin", "superAdmin"],
        "middleware": ["authenticateUser"]
      },
      "description": "Update user's profile picture. User can update their own profile picture.",
      "pathParameters": {
        "id": {
          "type": "string (ObjectId)",
          "required": true,
          "description": "User's MongoDB ObjectId",
          "note": "Typically should match authenticated user's ID"
        }
      },
      "requestBody": {
        "required": true,
        "contentType": "application/json",
        "schema": {
          "profilePicture": {
            "type": "string",
            "required": true,
            "description": "URL to the new profile picture",
            "example": "https://example.com/images/profile/johndoe.jpg"
          }
        }
      },
      "responses": {
        "200": {
          "description": "Profile picture updated successfully",
          "schema": {
            "message": "Profile picture updated successfully",
            "profilePicture": "string (the new profile picture URL)"
          },
          "example": {
            "message": "Profile picture updated successfully",
            "profilePicture": "https://example.com/images/profile/johndoe.jpg"
          }
        },
        "400": {
          "description": "Invalid request",
          "schema": {
            "message": "profilePicture URL is required and must be a string"
          }
        },
        "404": {
          "description": "User not found or inactive",
          "schema": {
            "message": "User not found or inactive"
          }
        },
        "500": {
          "description": "Server error",
          "schema": {
            "message": "Error updating profile picture",
            "error": "Error details"
          }
        }
      },
      "securityNotes": [
        "User ID is extracted from authenticated user's token (req.user._id)",
        "Any authenticated user can update their profile picture",
        "URL validation should be implemented on frontend"
      ]
    },
    "deleteUser": {
      "method": "POST",
      "path": "/api/users/:id",
      "authentication": true,
      "authorization": {
        "requiredRoles": ["admin", "superAdmin"],
        "middleware": ["authenticateUser", "checkAdmin"]
      },
      "description": "Deactivate a user account (soft delete - sets isActive to false)",
      "pathParameters": {
        "id": {
          "type": "string (ObjectId)",
          "required": true,
          "description": "User's MongoDB ObjectId to deactivate",
          "example": "507f1f77bcf86cd799439011"
        }
      },
      "requestBody": null,
      "responses": {
        "200": {
          "description": "User deactivated successfully",
          "schema": {
            "message": "User deactivated successfully"
          }
        },
        "400": {
          "description": "Invalid user ID format",
          "schema": {
            "message": "Invalid user ID format"
          }
        },
        "404": {
          "description": "User not found or already deactivated",
          "schema": {
            "message": "User not found or already deactivated"
          }
        },
        "500": {
          "description": "Server error",
          "schema": {
            "message": "Error deactivating user"
          }
        }
      },
      "businessLogic": {
        "deletionType": "Soft delete - user record remains in database",
        "implementation": "Sets isActive field to false",
        "userAccess": "Deactivated users cannot login or access the platform",
        "dataRetention": "User data is preserved for audit and compliance purposes"
      },
      "securityNotes": [
        "This is a soft delete, not a hard delete",
        "User data is retained in the database",
        "Deactivated users are excluded from most queries (isActive filter)"
      ]
    },
    "promoteToAdmin": {
      "method": "PATCH",
      "path": "/api/users/:id/role/admin",
      "authentication": true,
      "authorization": {
        "requiredRoles": ["admin", "superAdmin"],
        "middleware": ["authenticateUser", "checkAdmin"]
      },
      "description": "Promote a regular user to admin role",
      "pathParameters": {
        "id": {
          "type": "string (ObjectId)",
          "required": true,
          "description": "User's MongoDB ObjectId to promote",
          "example": "507f1f77bcf86cd799439011"
        }
      },
      "requestBody": null,
      "responses": {
        "200": {
          "description": "User promoted successfully",
          "schema": {
            "message": "User promoted to admin successfully"
          }
        },
        "404": {
          "description": "User not found or already an admin",
          "schema": {
            "message": "User not found or already an admin"
          }
        },
        "500": {
          "description": "Server error",
          "schema": {
            "message": "Error promoting user"
          }
        }
      },
      "businessLogic": {
        "roleChange": "Changes user.role from 'user' to 'admin'",
        "validation": "Checks that user exists and is not already an admin",
        "permissions": "Newly promoted admin gains admin-level access immediately"
      }
    },
    "demoteToUser": {
      "method": "PATCH",
      "path": "/api/users/:id/role/user",
      "authentication": true,
      "authorization": {
        "requiredRoles": ["superAdmin"],
        "middleware": ["authenticateUser", "checkSuperAdmin"]
      },
      "description": "Demote an admin to regular user role (superAdmin only)",
      "pathParameters": {
        "id": {
          "type": "string (ObjectId)",
          "required": true,
          "description": "Admin's MongoDB ObjectId to demote",
          "example": "507f1f77bcf86cd799439012"
        }
      },
      "requestBody": null,
      "responses": {
        "200": {
          "description": "Admin demoted successfully",
          "schema": {
            "message": "Admin demoted to user successfully"
          }
        },
        "404": {
          "description": "User not found or not an admin",
          "schema": {
            "message": "User not found or not an admin"
          }
        },
        "500": {
          "description": "Server error",
          "schema": {
            "message": "Error demoting user"
          }
        }
      },
      "businessLogic": {
        "roleChange": "Changes user.role from 'admin' to 'user'",
        "validation": "Checks that user exists and currently has admin role",
        "permissions": "Demoted user loses admin privileges immediately"
      },
      "securityNotes": [
        "Only superAdmin can demote admins",
        "Regular admins cannot demote other admins",
        "SuperAdmin cannot demote themselves (would need another superAdmin)"
      ]
    }
  },
  "commonResponseStructure": {
    "success": {
      "format": "Varies by endpoint",
      "note": "Some endpoints return objects, some return arrays, some return custom response objects with message and data fields"
    },
    "error": {
      "format": {
        "message": "string (human-readable error message)",
        "error": "string | object (optional error details)"
      }
    }
  },
  "authenticationFlow": {
    "description": "All endpoints except public routes require authentication",
    "tokenSource": "JWT token from Authorization header or auth_token cookie",
    "userObject": "Authenticated user available in req.user after authentication middleware",
    "middlewareChain": [
      "authenticateUser - Validates token and loads user",
      "checkAdmin - Verifies user has admin or superAdmin role",
      "checkSuperAdmin - Verifies user has superAdmin role only",
      "require2FA - Requires 2FA verification if enabled"
    ]
  },
  "businessRules": {
    "userSearch": {
      "purpose": "Enable P2P transfers by allowing users to find recipients",
      "privacy": "Email addresses are masked by default to protect user privacy",
      "filtering": "Only regular users (role='user') are searchable, excludes admins",
      "exclusion": "Current user is automatically excluded from search results",
      "configuration": "Search behavior controlled by system settings"
    },
    "profileUpdates": {
      "registrationBonusIntegration": "Profile updates trigger registration bonus eligibility check",
      "passwordSecurity": "Passwords are automatically hashed with bcrypt",
      "roleProtection": "User role cannot be changed via general update endpoint"
    },
    "softDelete": {
      "implementation": "Users are deactivated (isActive=false) rather than deleted",
      "queryFiltering": "Most queries filter for isActive=true automatically",
      "dataRetention": "User data preserved for compliance and audit purposes"
    },
    "roleManagement": {
      "promotion": "Admin or superAdmin can promote users to admin",
      "demotion": "Only superAdmin can demote admins to users",
      "hierarchy": "user < admin < superAdmin"
    }
  },
  "frontendIntegrationGuide": {
    "userManagementUI": {
      "adminPanel": [
        "Display user list with filtering (getAllUsers)",
        "Show user details modal (getUserById)",
        "Provide promote/demote role buttons (promoteToAdmin, demoteToUser)",
        "Enable user deactivation with confirmation (deleteUser)",
        "Implement user profile editing form (updateUser)"
      ],
      "userProfile": [
        "Allow users to view their own profile (getUserById with own ID)",
        "Enable profile picture upload (updateProfilePicture)",
        "Note: Profile updates should use updateUser but may require admin access"
      ],
      "p2pTransfer": [
        "Implement username search with debouncing (searchUsersByUsername)",
        "Display masked emails for privacy",
        "Show user selection from search results",
        "Validate recipient before initiating transfer"
      ]
    },
    "errorHandling": {
      "400": "Show validation error message to user",
      "401": "Redirect to login page",
      "403_SEARCH_DISABLED": "Show 'Search feature temporarily unavailable' message",
      "403_INSUFFICIENT_PERMISSIONS": "Show 'Access denied' message",
      "404": "Show 'User not found' message",
      "500": "Show generic error message, log details for debugging"
    },
    "roleBasedDisplay": {
      "user": "Can only view own profile and search other users",
      "admin": "Can view all users, promote users, deactivate users, edit any profile",
      "superAdmin": "All admin capabilities plus demote admins"
    },
    "formValidation": {
      "username": "Minimum 2 characters for search",
      "profilePicture": "Must be valid URL string",
      "userId": "Must be valid MongoDB ObjectId format (24 hex characters)"
    }
  },
  "userRankEndpoints": {
    "baseUrl": "/api/user-rank",
    "description": "User rank system endpoints for viewing rank information, pool distributions, and team data",
    "endpoints": [
      {
        "method": "GET",
        "path": "/api/user-rank/my-rank",
        "description": "Get current user's rank information including current rank, qualification status, and verification icons",
        "authentication": "Required (JWT or Session)",
        "authorization": "User (own data)",
        "requestHeaders": {
          "Authorization": "Bearer <token>",
          "Content-Type": "application/json"
        },
        "requestBody": null,
        "successResponse": {
          "code": 200,
          "body": {
            "success": true,
            "message": "Rank information retrieved successfully",
            "data": {
              "currentRank": "Associate Stakeholder",
              "previousRank": "Stakeholder",
              "isQualified": true,
              "verificationIcon": "blue",
              "personalStake": 1500,
              "teamStake": 5000,
              "directDownlines": 8,
              "lowerRankDownlines": 3,
              "rankAchievedAt": "2024-09-15T10:00:00.000Z",
              "poolEligibility": {
                "rankPool": true,
                "redistributionPool": false
              },
              "nextRankRequirements": {
                "rank": "Senior Stakeholder",
                "personalStakeNeeded": 1500,
                "teamStakeNeeded": 10000,
                "directDownlinesNeeded": 5,
                "lowerRankDownlinesNeeded": 2
              }
            }
          }
        },
        "errorResponses": [
          { "code": 401, "description": "Unauthorized - Invalid or missing token" },
          { "code": 404, "description": "Rank information not found" },
          { "code": 500, "description": "Internal server error" }
        ]
      },
      {
        "method": "GET",
        "path": "/api/user-rank/calculate-rank",
        "description": "Calculate user's current rank eligibility based on real-time data",
        "authentication": "Required (JWT or Session)",
        "authorization": "User (own data)",
        "requestHeaders": {
          "Authorization": "Bearer <token>",
          "Content-Type": "application/json"
        },
        "successResponse": {
          "code": 200,
          "body": {
            "success": true,
            "message": "Rank calculated successfully",
            "data": {
              "calculatedRank": "Associate Stakeholder",
              "currentRank": "Associate Stakeholder",
              "rankChanged": false,
              "qualificationMet": true,
              "requirements": {
                "personalStake": { "required": 1000, "current": 1500, "met": true },
                "teamStake": { "required": 5000, "current": 5000, "met": true },
                "directDownlines": { "required": 5, "current": 8, "met": true },
                "lowerRankDownlines": { "required": 2, "current": 3, "met": true }
              }
            }
          }
        }
      },
      {
        "method": "GET",
        "path": "/api/user-rank/my-pool-distributions",
        "description": "Get user's rank pool and redistribution pool distribution history",
        "authentication": "Required (JWT or Session)",
        "authorization": "User (own data)",
        "queryParameters": {
          "page": "Page number (default: 1)",
          "limit": "Items per page (default: 10)",
          "distributionType": "Filter by rank_pool or redistribution_pool"
        },
        "successResponse": {
          "code": 200,
          "body": {
            "success": true,
            "message": "Pool distributions retrieved successfully",
            "data": {
              "distributions": [
                {
                  "_id": "distribution_id",
                  "distributionType": "rank_pool",
                  "rankName": "Associate Stakeholder",
                  "bonusAmount": 250,
                  "totalPoolAmount": 5000,
                  "userShare": 0.05,
                  "verificationIcon": "blue",
                  "distributionPeriod": "2024-10-07T00:00:00.000Z",
                  "distributionFrequency": "weekly"
                }
              ],
              "totalDistributions": 45,
              "totalEarned": 11250,
              "currentPage": 1,
              "totalPages": 5
            }
          }
        }
      },
      {
        "method": "GET",
        "path": "/api/user-rank/my-rank-history",
        "description": "Get user's rank achievement history showing all rank progressions",
        "authentication": "Required (JWT or Session)",
        "authorization": "User (own data)",
        "successResponse": {
          "code": 200,
          "body": {
            "success": true,
            "message": "Rank history retrieved successfully",
            "data": {
              "achievements": [
                {
                  "_id": "achievement_id",
                  "previousRank": "Stakeholder",
                  "newRank": "Associate Stakeholder",
                  "achievedAt": "2024-09-15T10:00:00.000Z",
                  "personalStakeAtAchievement": 1500,
                  "teamStakeAtAchievement": 5000,
                  "directDownlinesAtAchievement": 8,
                  "isActive": true,
                  "isQualified": true
                }
              ],
              "totalAchievements": 2,
              "currentRank": "Associate Stakeholder",
              "joinDate": "2024-01-15T10:30:00.000Z"
            }
          }
        }
      },
      {
        "method": "GET",
        "path": "/api/user-rank/my-team",
        "description": "Get user's team information including direct downlines and their ranks",
        "authentication": "Required (JWT or Session)",
        "authorization": "User (own data)",
        "successResponse": {
          "code": 200,
          "body": {
            "success": true,
            "message": "Team information retrieved successfully",
            "data": {
              "totalTeamMembers": 15,
              "directDownlines": 8,
              "teamStake": 12500,
              "downlinesByRank": {
                "Stakeholder": 5,
                "Associate Stakeholder": 2,
                "Senior Stakeholder": 1
              },
              "team": [
                {
                  "userId": "user_id",
                  "username": "user123",
                  "rank": "Associate Stakeholder",
                  "personalStake": 1200,
                  "teamStake": 3500,
                  "joinedAt": "2024-08-20T10:00:00.000Z",
                  "isDirect": true
                }
              ]
            }
          }
        }
      },
      {
        "method": "GET",
        "path": "/api/user-rank/next-rank-requirements",
        "description": "Get requirements and shortfalls for achieving the next rank",
        "authentication": "Required (JWT or Session)",
        "authorization": "User (own data)",
        "successResponse": {
          "code": 200,
          "body": {
            "success": true,
            "message": "Next rank requirements retrieved successfully",
            "data": {
              "currentRank": "Associate Stakeholder",
              "nextRank": "Senior Stakeholder",
              "requirements": {
                "personalStake": 3000,
                "teamStake": 15000,
                "directDownlines": 10,
                "lowerRankDownlines": 3
              },
              "current": {
                "personalStake": 1500,
                "teamStake": 5000,
                "directDownlines": 8,
                "lowerRankDownlines": 2
              },
              "shortfalls": {
                "personalStake": 1500,
                "teamStake": 10000,
                "directDownlines": 2,
                "lowerRankDownlines": 1
              },
              "progressPercentage": {
                "personalStake": 50,
                "teamStake": 33.33,
                "directDownlines": 80,
                "lowerRankDownlines": 66.67,
                "overall": 57.5
              }
            }
          }
        }
      },
      {
        "method": "GET",
        "path": "/api/user-rank/my-incentive-wallet",
        "description": "Get summary of rank and redistribution pool earnings (incentive wallet)",
        "authentication": "Required (JWT or Session)",
        "authorization": "User (own data)",
        "successResponse": {
          "code": 200,
          "body": {
            "success": true,
            "message": "Incentive wallet summary retrieved successfully",
            "data": {
              "totalEarnings": 15750,
              "rankPoolEarnings": 11250,
              "redistributionPoolEarnings": 4500,
              "currentWeekEstimate": 300,
              "last30DaysEarnings": 3600,
              "averageWeeklyEarnings": 900,
              "distributionHistory": [
                {
                  "week": "2024-W41",
                  "rankPool": 250,
                  "redistributionPool": 100,
                  "total": 350
                }
              ]
            }
          }
        }
      }
    ]
  },
  "notificationEndpoints": {
    "baseUrl": "/api/notification",
    "description": "User notification management endpoints",
    "endpoints": [
      {
        "method": "GET",
        "path": "/api/notification/",
        "description": "Get all notifications for current user with pagination and filtering",
        "authentication": "Required (JWT or Session)",
        "queryParameters": {
          "page": "Page number (default: 1)",
          "limit": "Items per page (default: 20)",
          "type": "Filter by type (info, warning, success, error, referral, depletion, goal, system)",
          "isRead": "Filter by read status (true/false)",
          "category": "Filter by category (referral_bonus, goal_progress, withdrawal, system, general)"
        },
        "successResponse": {
          "code": 200,
          "body": {
            "success": true,
            "message": "Notifications retrieved successfully",
            "data": {
              "notifications": [
                {
                  "_id": "notification_id",
                  "title": "Referral Bonus Earned",
                  "message": "You earned $50 from referral bonus (Level 1)",
                  "type": "referral",
                  "category": "referral_bonus",
                  "priority": "medium",
                  "isRead": false,
                  "actionRequired": false,
                  "actionUrl": "/referrals",
                  "actionText": "View Details",
                  "createdAt": "2024-10-12T10:00:00.000Z"
                }
              ],
              "totalNotifications": 45,
              "unreadCount": 12,
              "currentPage": 1,
              "totalPages": 3
            }
          }
        }
      },
      {
        "method": "GET",
        "path": "/api/notification/counts",
        "description": "Get notification counts (total, unread, by category)",
        "authentication": "Required (JWT or Session)",
        "successResponse": {
          "code": 200,
          "body": {
            "success": true,
            "data": {
              "total": 45,
              "unread": 12,
              "byCategory": {
                "referral_bonus": 8,
                "goal_progress": 15,
                "withdrawal": 5,
                "system": 12,
                "general": 5
              },
              "byPriority": {
                "urgent": 2,
                "high": 5,
                "medium": 20,
                "low": 18
              }
            }
          }
        }
      },
      {
        "method": "PATCH",
        "path": "/api/notification/:notificationId/read",
        "description": "Mark a specific notification as read",
        "authentication": "Required (JWT or Session)",
        "pathParameters": {
          "notificationId": "ID of the notification to mark as read"
        },
        "successResponse": {
          "code": 200,
          "body": {
            "success": true,
            "message": "Notification marked as read",
            "data": {
              "notification": {
                "_id": "notification_id",
                "isRead": true,
                "readAt": "2024-10-12T11:00:00.000Z"
              }
            }
          }
        }
      },
      {
        "method": "PATCH",
        "path": "/api/notification/mark-all-read",
        "description": "Mark all user notifications as read",
        "authentication": "Required (JWT or Session)",
        "successResponse": {
          "code": 200,
          "body": {
            "success": true,
            "message": "All notifications marked as read",
            "data": {
              "updatedCount": 12
            }
          }
        }
      },
      {
        "method": "DELETE",
        "path": "/api/notification/:notificationId",
        "description": "Delete a specific notification",
        "authentication": "Required (JWT or Session)",
        "pathParameters": {
          "notificationId": "ID of the notification to delete"
        },
        "successResponse": {
          "code": 200,
          "body": {
            "success": true,
            "message": "Notification deleted successfully"
          }
        }
      }
    ]
  },
  "socialMediaEndpoints": {
    "baseUrl": "/api/social-media",
    "description": "Social media platform verification for registration bonus",
    "endpoints": [
      {
        "method": "GET",
        "path": "/api/social-media/visit/:platform",
        "description": "Visit a social media platform and track the visit",
        "authentication": "Required (JWT or Session)",
        "pathParameters": {
          "platform": "Platform name (youtube, facebook, tiktok, instagram, telegram)"
        },
        "successResponse": {
          "code": 302,
          "description": "Redirect to social media platform URL",
          "headers": {
            "Location": "https://youtube.com/@novunt"
          }
        }
      },
      {
        "method": "POST",
        "path": "/api/social-media/confirm/:platform",
        "description": "Confirm social media platform visit after dwell time",
        "authentication": "Required (JWT or Session)",
        "rateLimiting": "10 requests per minute per IP",
        "pathParameters": {
          "platform": "Platform name (youtube, facebook, tiktok, instagram, telegram)"
        },
        "successResponse": {
          "code": 200,
          "body": {
            "success": true,
            "message": "Platform verification confirmed",
            "data": {
              "platform": "youtube",
              "isVerified": true,
              "verifiedAt": "2024-10-12T10:30:00.000Z"
            }
          }
        },
        "errorResponses": [
          { "code": 400, "description": "Insufficient dwell time" },
          { "code": 429, "description": "Too many confirmation attempts" }
        ]
      }
    ]
  },
  "achievementEndpoints": {
    "baseUrl": "/api/achievements",
    "description": "Achievement badge system for gamification",
    "endpoints": [
      {
        "method": "GET",
        "path": "/api/achievements/catalog",
        "description": "Get all available achievement badges (catalog)",
        "authentication": "Not required",
        "successResponse": {
          "code": 200,
          "body": {
            "success": true,
            "message": "All badges retrieved successfully",
            "data": {
              "totalBadges": 28,
              "badges": [
                {
                  "badgeType": "first_stake",
                  "title": "First Stake",
                  "description": "Complete your first stake",
                  "icon": "ðŸŽ¯",
                  "rarity": "common",
                  "category": "staking"
                },
                {
                  "badgeType": "stake_1000",
                  "title": "Stakeholder 1K",
                  "description": "Stake 1000 USDT or more",
                  "icon": "ðŸ’Ž",
                  "rarity": "rare",
                  "category": "staking"
                }
              ]
            }
          }
        }
      },
      {
        "method": "GET",
        "path": "/api/achievements/me",
        "description": "Get current user's earned badges",
        "authentication": "Required (JWT or Session)",
        "successResponse": {
          "code": 200,
          "body": {
            "success": true,
            "message": "User badges retrieved successfully",
            "data": {
              "totalEarned": 8,
              "badges": [
                {
                  "_id": "badge_id",
                  "badgeType": "first_stake",
                  "title": "First Stake",
                  "description": "Complete your first stake",
                  "icon": "ðŸŽ¯",
                  "rarity": "common",
                  "awardedAt": "2024-01-16T10:00:00.000Z",
                  "isDisplayed": true
                }
              ]
            }
          }
        }
      },
      {
        "method": "GET",
        "path": "/api/achievements/progress",
        "description": "Get user's progress toward unearned badges",
        "authentication": "Required (JWT or Session)",
        "successResponse": {
          "code": 200,
          "body": {
            "success": true,
            "data": {
              "inProgress": [
                {
                  "badgeType": "stake_1000",
                  "title": "Stakeholder 1K",
                  "progress": {
                    "current": 750,
                    "required": 1000,
                    "percentage": 75
                  },
                  "rarity": "rare"
                }
              ]
            }
          }
        }
      }
    ]
  }
}

